{"config":{"id":"","title":"New Page","version":{"name":"Dunant 5","nameSuffix":"Hotfix 1","product":"Design","platform":"SharePoint","date":"Tue, 01 May 2018 17:07:02 GMT"},"width":null,"height":null,"pageRoute":null,"bgColor":"rgb(255, 255, 255)","bgImage":"","bgImageStyle":2,"isBgFixed":true,"layoutType":"TableLayout","designerType":"TableDesigner","pageType":"Page","layoutConfig":{"children":[{"layoutType":"RowLayout","children":[{"layoutType":"ColumnLayout","largeWidth":12,"mediumWidth":12,"smallWidth":12,"extraSmallWidth":12,"children":[{"layoutType":"TableLayout","children":[{"tileType":"AdvancedCodeSnippetTile","name":"Custom","width":442,"height":160,"bgColor":"white","iconPath":"https://ltd-preview.azureedge.net/sharepoint/v4/content/Icons/Tile Gallery/Code.svg","id":"oqrendql","locked":false,"html":"<div id=\"{{uniqueId}}\">\n\t<h3>Graph Example Loading...</h3>\n</div>","css":"h2 {\r\n    \r\n}","js":"function render(meResponse) {\n\t// Pulls out the tile by uniqueID from the page then re-renders it using jQuery\n    var $tile = $(\"#\"+uniqueId);\n\t$tile.children().remove();\n\t// Try uncommenting this debugger statement and running with the dev tools open\n\t// debugger;\n\t$tile.append($(\"<h1>\" + meResponse.displayName + \"</h1>\"))\n\t$tile.append($(\"<h2>\" + meResponse.jobTitle + \"</h2>\"))\n\t$tile.append($(\"<h3><a href='mailto:\" + meResponse.mail +\"'>\" + meResponse.mail + \"</a></h3>\"))\n}\n\nfunction callTheGraph(token) {\n\t// In this example, call the graph with just the \"Me\" endpoint\n\t// We'll then pass off to the render function to change the tile\n    return $.ajax({\n\t\t\t\turl: \"https://graph.microsoft.com/v1.0/me/\",\n\t\t\t\tmethod: \"GET\",\n\t\t\t\theaders: {\n\t\t\t\t\t'Authorization': `Bearer ${token}`,\n\t\t\t\t\t'Content-Type': 'application/json;odata.metadata=minimal'\n\t\t\t\t},\n\t\t\t\tsuccess: (data, textStatus, jqXHR) => {\n\t\t\t\t\trender(data);\n\t\t\t\t},\n\t\t\t\terror: (jqXHR, textStatus, errorThrown) => {\n\t\t\t\t\talert(\"Something went wrong!\");\n\t\t\t\t}\n\t\t\t});\n}\n\n// Try to get the auth token\nLiveTilesApi.Authentication.getAuthenticationInfo({ serviceName: \"Office365\"}).then(function(token) {\n\n\t// If we couldn't get the authtoken, then login for it\n    if(!token) {\n        LiveTilesApi.Authentication.login({ serviceName: \"Office365\"}).then(function(loginToken) {\n            callTheGraph(loginToken.accessToken);\n        });\n    } else {\n        callTheGraph(token.accessToken);\n    }\n});","isAutoHeight":true,"isSandbox":false,"canDesignersEditCode":true,"customConfig":{"props":[{"title":"Title","name":"title","type":0},{"title":"Text Color","name":"color","type":2},{"title":"Delay Milliseconds","name":"delayMs","type":1}],"values":{"title":"Hello, World!","color":"black","delayMs":200}},"groupTargeting":{"targetingMode":"NoTargeting","targetedGroups":[],"includeNested":true}}],"showForLarge":true,"showforMedium":true,"showForSmall":true,"showForExtraSmall":true}]}],"bgColor":"transparent","padding":{"paddingBottom":0,"paddingLeft":0,"paddingRight":0,"paddingTop":0},"cellPadding":{"paddingBottom":15,"paddingLeft":15,"paddingRight":15,"paddingTop":0},"showForLarge":true,"showforMedium":true,"showForSmall":true,"showForExtraSmall":true}],"padding":{"paddingLeft":10,"paddingRight":10,"paddingTop":10,"paddingBottom":10},"widthStyle":0,"percentageWidth":100,"pixelWidth":1280,"isFixedSidePadding":true},"font":{"fontFamily":"Lato, 'Segoe UI', 'Helvetica Neue', sans-serif","fontSize":"13","fontColor":"black","isItalic":false,"fontWeight":"normal","isUnderlined":false,"fontFamilyOptions":{"isCustom":true,"selectedFont":"Lato, 'Segoe UI', 'Helvetica Neue', sans-serif","customFont":""}},"is3dStyle":false,"displaySideMenu":false,"designerStyle":0,"hasUpgradeRequestsMetaTag":true,"wireframeModeConfig":{"isEnabled":false,"isActive":false,"isInteractive":false},"assetData":{}},"dependencies":[{"url":"https://ltd-preview.azureedge.net/sharepoint/v4/content/Icons/Tile Gallery/Code.svg","toCopy":false}]}